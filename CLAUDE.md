# CLAUDE.md

This file provides guidance to Claude Code when working with this repository.

## Critical Rules

1. **NEVER commit directly to main** - Always create a feature branch and submit a pull request
2. **Conventional commits** - Format: `type(scope): description`
3. **GitHub Issues for TODOs** - Use `gh` CLI to manage issues, no local TODO files
4. **Pull Request titles** - Use conventional commit format
5. **Branch naming** - Format: `type/scope/short-description` (e.g., `feat/parser/yaml-support`)
6. **No co-authors** - Do not add co-author information on commits or pull requests
7. **No "generated by" statements** - Do not add generated-by statements on pull requests

## Project Overview

**rnr** (pronounced "runner") is a cross-platform task runner designed for zero-setup execution. Clone a repo and tasks just work - no dependency installs, no global tools, no configuration.

## Tech Stack

- **Language**: Rust
- **Target Platforms**: Windows, macOS, Linux
- **Task File Format**: YAML (`rnr.yaml`)

## Build Commands

```bash
# Build
cargo build

# Build release
cargo build --release

# Run tests
cargo test

# Run clippy
cargo clippy

# Format code
cargo fmt

# Run rnr locally
cargo run -- <args>
```

## Project Structure

```
rnr.cli/
├── src/
│   ├── main.rs           # Entry point
│   ├── cli.rs            # CLI argument parsing (clap)
│   ├── config.rs         # rnr.yaml parsing (serde)
│   ├── runner.rs         # Task execution
│   ├── commands/
│   │   ├── mod.rs
│   │   ├── init.rs       # rnr init command
│   │   ├── upgrade.rs    # rnr upgrade command
│   │   └── list.rs       # rnr --list command
│   └── ...
├── Cargo.toml
├── DESIGN.md             # Detailed design document
├── CLAUDE.md             # This file
└── README.md
```

## Architecture

See `DESIGN.md` for complete design documentation including:
- Task file schema
- Built-in commands
- MVP features
- Future features

## Conventions

### Task File Schema

Tasks are defined in `rnr.yaml`:

```yaml
# Shorthand
build: cargo build --release

# Full form
test:
  description: Run all tests
  dir: src/
  env:
    RUST_LOG: debug
  cmd: cargo test
```

### Error Handling

- Use `anyhow` for application errors
- Use `thiserror` for library errors
- Provide clear, actionable error messages

### Code Style

- Follow Rust idioms
- Use `clippy` for linting
- Use `rustfmt` for formatting
- Prefer explicit error handling over `.unwrap()`
